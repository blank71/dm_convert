{%- import 'macros.jinja' as macros %}
apiVersion: compute.cnrm.cloud.google.com/v1beta1
kind: ComputeHealthCheck
metadata:
{%- set properties = resource.get('properties', {}) %}
{{- macros.fields(properties, {'labels': 'labels'}, ' ' * 2) }}
{%- if 'name' in properties %}
  name: {{ properties['name'] | arbitrary_reference }}
{%- else %}
  name: {{ resource['name'] | arbitrary_reference }}
{%- endif %}
{%- if properties | set_difference(['name', 'labels', 'project']) %}
{# At least one field of properties was not converted to metadata and will be converted to spec. #}
spec:
  {{- macros.fields(properties, {
    'checkIntervalSec': 'checkIntervalSec',
    'description': 'description',
    'grpcHealthCheck': 'grpcHealthCheck',
    'healthyThreshold': 'healthyThreshold',
    'http2HealthCheck': 'http2HealthCheck',
    'httpHealthCheck': 'httpHealthCheck',
    'httpsHealthCheck': 'httpsHealthCheck',
    'logConfig': 'logConfig',
    'sslHealthCheck': 'sslHealthCheck',
    'tcpHealthCheck': 'tcpHealthCheck',
    'timeoutSec': 'timeoutSec',
    'unhealthyThreshold': 'unhealthyThreshold',
  }, ' ' * 2) }}
{%- endif %}
{%- if 'region' in properties %}
  location: {{ properties['region'] }}
{%- else %}
  location: global
{%- endif %}
