resources:
- name: vm-1
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/family/debian-11
      type: PERSISTENT
    machineType: https://www.googleapis.com/compute/v1/projects/some_project/zones/us-central1-f/machineTypes/f1-micro
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: $(ref.network-1.selfLink)
    zone: us-central1-f
  type: compute.v1.instance
  metadata:
    dependsOn:
    - network-1
- name: vm-2
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/family/debian-11
      type: PERSISTENT
    machineType: https://www.googleapis.com/compute/v1/projects/some_project/zones/us-west1-a/machineTypes/g1-small
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: $(ref.network-1.selfLink)
    zone: us-west1-a
  type: compute.v1.instance
  metadata:
    dependsOn:
    - network-1
- name: network-1
  properties:
    autoCreateSubnetworks: true
    routingConfig:
      routingMode: REGIONAL
  type: compute.v1.network
- name: firewall-1
  properties:
    allowed:
    - IPProtocol: TCP
      ports:
      - 80
    network: $(ref.network-1.selfLink)
    sourceRanges:
    - 0.0.0.0/0
  type: compute.v1.firewall
  metadata:
    dependsOn:
    - network-1
- name: vm-3
  properties:
    disks:
    - autoDelete: true
      boot: true
      deviceName: boot
      initializeParams:
        sourceImage: https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/family/debian-11
      type: PERSISTENT
    machineType: https://www.googleapis.com/compute/v1/projects/some_project/zones/us-central1-a/machineTypes/e2-small
    networkInterfaces:
    - accessConfigs:
      - name: External NAT
        type: ONE_TO_ONE_NAT
      network: $(ref.network-2.selfLink)
    zone: us-central1-a
  type: compute.v1.instance
  metadata:
    dependsOn:
    - network-2
- name: network-2
  properties:
    autoCreateSubnetworks: true
    routingConfig:
      routingMode: REGIONAL
  type: compute.v1.network
